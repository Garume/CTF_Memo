<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script>

# RSA 暗号

## RSA 暗号とは?

chatGPT に聞いてみました。

`
RSA暗号とは、公開鍵暗号の一種で、1977年にロナルド・リベスト、アディ・シャミア、レナード・アデルマンによって開発された暗号システムです。公開鍵暗号では、暗号化に使う鍵（公開鍵）と復号化に使う鍵（秘密鍵）が異なります。RSA暗号は、数学的に有名な素因数分解の困難さを利用しています。`

## 基本的な説明

RSA 暗号の手順は以下

1. 大きな素数 p と q を選び、それらの積$$ n = p \ * q $$を計算します。
2. 乗法に関するオイラーの関数$$ φ(n) = (p - 1)(q - 1) $$を計算します。
3. 1 < e < φ(n)を満たす公開鍵 e を選びます。e は φ(n)と互いに素である必要があります。
4. 次を満たす秘密鍵 d を計算します。$$ de ≡ 1 (mod \ φ(n)) $$
5. このとき、公開鍵は(n, e)、秘密鍵は(n, d)となります。

---

ここでオイラー関数とは何ぞや？  
下で説明しときました。

---

## 暗号化

平文（メッセージ）を M とし、0 ≤ M < n であるとします。  
暗号文 C は以下の式で計算されます

$$ C ≡ M^e (mod \ n) $$

## 復号化

受信者は秘密鍵 d を使用して暗号文 C から平文 M を復元します

$$ M ≡ C^d (mod \ n) $$

### 例

ここでは、実際の数値を使って RSA 暗号の暗号化と復号化のプロセスを説明します。

1. $$ p = 61, q = 53 $$
2. $$ n = p _ q = 61 _ 53 = 3233 $$
3. $$ φ(n) = (p - 1)(q - 1) = 60 * 52 = 3120 $$
4. $$ e = 17 \ を選択 $$

5. $$ d * 17 ≡ 1 (mod \ 3120 ) \\ より \ \ d ≡ 2753 $$

したがって次が分かる。

### 公開鍵：(n, e) = (3233, 17)

### 秘密鍵：(n, d) = (3233, 2753)

平文 M = 65（たとえば、'A'の ASCII コード）だとすると、  
`暗号化` = M^e (mod n) = 65^17 (mod 3233) = 2790  
`復号化` = C^d (mod n) = 2790^2753 (mod 3233) = 65

---

## オイラー関数

`オイラー関数は、数論における重要な関数で、φ(n)（ファイ(n)）と表記されます。オイラー関数は、与えられた正の整数nに対して、1からnまでの整数のうち、nと互いに素（最大公約数が1）である整数の個数を表します。`

### 性質

1. 素数 p に対して、$$φ(p) = p - 1 $$  
   なぜなら、素数は 1 とそれ自身以外に約数を持たないため、1 から p-1 までのすべての整数が p と互いに素だからです。
2. 互いに素な a と b に対して、$$φ(ab) = φ(a)φ(b)$$

### 結論

素数 p,q がありその積を n とすると、  
$$φ(n) = φ(p*q) = φ(p)φ(q) = (p-1) * (q-1)$$
が成り立つ
